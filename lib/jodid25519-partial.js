/*
 * Curve 25519-based cryptography collection.
 *
 * EC Diffie-Hellman (ECDH) based on Curve25519 and digital signatures (EdDSA)
 * based on Ed25519.
 * 
 * Copyright (c) 2012 Ron Garret
 * Copyright (c) 2007, 2013, 2014 Michele Bini
 * Copyright (c) 2014 Mega Limited
 * under the MIT License.
 * 
 * You should have received a copy of the license along with this program.
 */

/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*
 * Copyright (c) 2007, 2013, 2014 Michele Bini
 * Copyright (c) 2014 Mega Limited
 * under the MIT License.
 * 
 * Authors: Guy K. Kloss, Michele Bini
 * 
 * You should have received a copy of the license along with this program.
 */

/*
 * Copyright (c) 2011, 2012, 2014 Ron Garret
 * Copyright (c) 2007, 2013, 2014 Michele Bini
 * Copyright (c) 2014 Mega Limited
 * under the MIT License.
 * 
 * Authors: Guy K. Kloss, Michele Bini, Ron Garret
 * 
 * You should have received a copy of the license along with this program.
 */

/*
 * Copyright (c) 2014 Mega Limited
 * under the MIT License.
 * 
 * Authors: Guy K. Kloss
 * 
 * You should have received a copy of the license along with this program.
 */

/*
 * Copyright (c) 2011, 2012, 2014 Ron Garret
 * Copyright (c) 2014 Mega Limited
 * under the MIT License.
 * 
 * Authors: Guy K. Kloss, Ron Garret
 * 
 * You should have received a copy of the license along with this program.
 */

(function(e,t){typeof define=="function"&&define.amd?define([],t):typeof module=="object"&&module.exports?module.exports=t():e.jodid25519=t()})(this,function(){var e,t,n;return function(r){function v(e,t){return h.call(e,t)}function m(e,t){var n,r,i,s,o,u,a,f,c,h,p,v=t&&t.split("/"),m=l.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){v=v.slice(0,v.length-1),e=e.split("/"),o=e.length-1,l.nodeIdCompat&&d.test(e[o])&&(e[o]=e[o].replace(d,"")),e=v.concat(e);for(c=0;c<e.length;c+=1){p=e[c];if(p===".")e.splice(c,1),c-=1;else if(p===".."){if(c===1&&(e[2]===".."||e[0]===".."))break;c>0&&(e.splice(c-1,2),c-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(c=n.length;c>0;c-=1){r=n.slice(0,c).join("/");if(v)for(h=v.length;h>0;h-=1){i=m[v.slice(0,h).join("/")];if(i){i=i[r];if(i){s=i,u=c;break}}}if(s)break;!a&&g&&g[r]&&(a=g[r],f=c)}!s&&a&&(s=a,u=f),s&&(n.splice(0,u,s),e=n.join("/"))}return e}function g(e,t){return function(){return s.apply(r,p.call(arguments,0).concat([e,t]))}}function y(e){return function(t){return m(t,e)}}function b(e){return function(t){a[e]=t}}function w(e){if(v(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!v(a,e)&&!v(c,e))throw new Error("No "+e);return a[e]}function E(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function S(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice,d=/\.js$/;o=function(e,t){var n,r=E(e),i=r[0];return e=r[1],i&&(i=m(i,t),n=w(i)),i?n&&n.normalize?e=n.normalize(e,y(t)):e=m(e,t):(e=m(e,t),r=E(e),i=r[0],e=r[1],i&&(n=w(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return g(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:S(e)}}},i=function(e,t,n,i){var s,l,h,p,d,m=[],y=typeof n,E;i=i||e;if(y==="undefined"||y==="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(d=0;d<t.length;d+=1){p=o(t[d],i),l=p.f;if(l==="require")m[d]=u.require(e);else if(l==="exports")m[d]=u.exports(e),E=!0;else if(l==="module")s=m[d]=u.module(e);else if(v(a,l)||v(f,l)||v(c,l))m[d]=w(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,g(i,!0),b(l),{}),m[d]=a[l]}}h=n?n.apply(a[e],m):undefined;if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!E)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){if(typeof e=="string")return u[e]?u[e](t):w(o(e,t).f);if(!e.splice){l=e,l.deps&&s(l.deps,l.callback);if(!t)return;t.splice?(e=t,t=n,n=null):e=r}return t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s},s.config=function(e){return s(e)},e._defined=a,n=function(e,t,n){t.splice||(n=t,t=[]),!v(a,e)&&!v(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("../node_modules/almond/almond",function(){}),n("jodid25519/core",[],function(){function t(e,t,n){var r=t>>4,i=e[r];i+=(1<<(t&15))*n,e[r]=i}function n(e,t){return e[t>>4]>>(t&15)&1}function r(){return[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}function i(){return[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}function s(){return[9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}function o(e,t){var n,r,i,s=0;for(n=15;n>=0;n--){var o=e[n],u=t[n];s+=(o-u)*(1-s*s),i=s>>31,r=s+i^i,s=~~((s<<1)/(r+1))}return s}function u(e,t){var n=[],r;return n[0]=(r=e[0]+t[0])&65535,n[1]=(r=(r>>>16)+e[1]+t[1])&65535,n[2]=(r=(r>>>16)+e[2]+t[2])&65535,n[3]=(r=(r>>>16)+e[3]+t[3])&65535,n[4]=(r=(r>>>16)+e[4]+t[4])&65535,n[5]=(r=(r>>>16)+e[5]+t[5])&65535,n[6]=(r=(r>>>16)+e[6]+t[6])&65535,n[7]=(r=(r>>>16)+e[7]+t[7])&65535,n[8]=(r=(r>>>16)+e[8]+t[8])&65535,n[9]=(r=(r>>>16)+e[9]+t[9])&65535,n[10]=(r=(r>>>16)+e[10]+t[10])&65535,n[11]=(r=(r>>>16)+e[11]+t[11])&65535,n[12]=(r=(r>>>16)+e[12]+t[12])&65535,n[13]=(r=(r>>>16)+e[13]+t[13])&65535,n[14]=(r=(r>>>16)+e[14]+t[14])&65535,n[15]=(r>>>16)+e[15]+t[15],n}function a(e,t){var n=[],r;return n[0]=(r=524288+e[0]-t[0])&65535,n[1]=(r=(r>>>16)+524280+e[1]-t[1])&65535,n[2]=(r=(r>>>16)+524280+e[2]-t[2])&65535,n[3]=(r=(r>>>16)+524280+e[3]-t[3])&65535,n[4]=(r=(r>>>16)+524280+e[4]-t[4])&65535,n[5]=(r=(r>>>16)+524280+e[5]-t[5])&65535,n[6]=(r=(r>>>16)+524280+e[6]-t[6])&65535,n[7]=(r=(r>>>16)+524280+e[7]-t[7])&65535,n[8]=(r=(r>>>16)+524280+e[8]-t[8])&65535,n[9]=(r=(r>>>16)+524280+e[9]-t[9])&65535,n[10]=(r=(r>>>16)+524280+e[10]-t[10])&65535,n[11]=(r=(r>>>16)+524280+e[11]-t[11])&65535,n[12]=(r=(r>>>16)+524280+e[12]-t[12])&65535,n[13]=(r=(r>>>16)+524280+e[13]-t[13])&65535,n[14]=(r=(r>>>16)+524280+e[14]-t[14])&65535,n[15]=(r>>>16)-8+e[15]-t[15],n}function f(e,t,n,r,i,s,o,u){var a=[],f;return a[0]=(f=u*u)&65535,a[1]=(f=(0|f/65536)+2*u*o)&65535,a[2]=(f=(0|f/65536)+2*u*s+o*o)&65535,a[3]=(f=(0|f/65536)+2*u*i+2*o*s)&65535,a[4]=(f=(0|f/65536)+2*u*r+2*o*i+s*s)&65535,a[5]=(f=(0|f/65536)+2*u*n+2*o*r+2*s*i)&65535,a[6]=(f=(0|f/65536)+2*u*t+2*o*n+2*s*r+i*i)&65535,a[7]=(f=(0|f/65536)+2*u*e+2*o*t+2*s*n+2*i*r)&65535,a[8]=(f=(0|f/65536)+2*o*e+2*s*t+2*i*n+r*r)&65535,a[9]=(f=(0|f/65536)+2*s*e+2*i*t+2*r*n)&65535,a[10]=(f=(0|f/65536)+2*i*e+2*r*t+n*n)&65535,a[11]=(f=(0|f/65536)+2*r*e+2*n*t)&65535,a[12]=(f=(0|f/65536)+2*n*e+t*t)&65535,a[13]=(f=(0|f/65536)+2*t*e)&65535,a[14]=(f=(0|f/65536)+e*e)&65535,a[15]=0|f/65536,a}function l(e){var t=f(e[15],e[14],e[13],e[12],e[11],e[10],e[9],e[8]),n=f(e[7],e[6],e[5],e[4],e[3],e[2],e[1],e[0]),r=f(e[15]+e[7],e[14]+e[6],e[13]+e[5],e[12]+e[4],e[11]+e[3],e[10]+e[2],e[9]+e[1],e[8]+e[0]),i=[],s;return i[0]=(s=8388608+n[0]+(r[8]-t[8]-n[8]+t[0]-128)*38)&65535,i[1]=(s=8388480+(s>>>16)+n[1]+(r[9]-t[9]-n[9]+t[1])*38)&65535,i[2]=(s=8388480+(s>>>16)+n[2]+(r[10]-t[10]-n[10]+t[2])*38)&65535,i[3]=(s=8388480+(s>>>16)+n[3]+(r[11]-t[11]-n[11]+t[3])*38)&65535,i[4]=(s=8388480+(s>>>16)+n[4]+(r[12]-t[12]-n[12]+t[4])*38)&65535,i[5]=(s=8388480+(s>>>16)+n[5]+(r[13]-t[13]-n[13]+t[5])*38)&65535,i[6]=(s=8388480+(s>>>16)+n[6]+(r[14]-t[14]-n[14]+t[6])*38)&65535,i[7]=(s=8388480+(s>>>16)+n[7]+(r[15]-t[15]-n[15]+t[7])*38)&65535,i[8]=(s=8388480+(s>>>16)+n[8]+r[0]-t[0]-n[0]+t[8]*38)&65535,i[9]=(s=8388480+(s>>>16)+n[9]+r[1]-t[1]-n[1]+t[9]*38)&65535,i[10]=(s=8388480+(s>>>16)+n[10]+r[2]-t[2]-n[2]+t[10]*38)&65535,i[11]=(s=8388480+(s>>>16)+n[11]+r[3]-t[3]-n[3]+t[11]*38)&65535,i[12]=(s=8388480+(s>>>16)+n[12]+r[4]-t[4]-n[4]+t[12]*38)&65535,i[13]=(s=8388480+(s>>>16)+n[13]+r[5]-t[5]-n[5]+t[13]*38)&65535,i[14]=(s=8388480+(s>>>16)+n[14]+r[6]-t[6]-n[6]+t[14]*38)&65535,i[15]=8388480+(s>>>16)+n[15]+r[7]-t[7]-n[7]+t[15]*38,p(i),i}function c(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m=[],g;return m[0]=(g=u*v)&65535,m[1]=(g=(0|g/65536)+u*d+o*v)&65535,m[2]=(g=(0|g/65536)+u*p+o*d+s*v)&65535,m[3]=(g=(0|g/65536)+u*h+o*p+s*d+i*v)&65535,m[4]=(g=(0|g/65536)+u*c+o*h+s*p+i*d+r*v)&65535,m[5]=(g=(0|g/65536)+u*l+o*c+s*h+i*p+r*d+n*v)&65535,m[6]=(g=(0|g/65536)+u*f+o*l+s*c+i*h+r*p+n*d+t*v)&65535,m[7]=(g=(0|g/65536)+u*a+o*f+s*l+i*c+r*h+n*p+t*d+e*v)&65535,m[8]=(g=(0|g/65536)+o*a+s*f+i*l+r*c+n*h+t*p+e*d)&65535,m[9]=(g=(0|g/65536)+s*a+i*f+r*l+n*c+t*h+e*p)&65535,m[10]=(g=(0|g/65536)+i*a+r*f+n*l+t*c+e*h)&65535,m[11]=(g=(0|g/65536)+r*a+n*f+t*l+e*c)&65535,m[12]=(g=(0|g/65536)+n*a+t*f+e*l)&65535,m[13]=(g=(0|g/65536)+t*a+e*f)&65535,m[14]=(g=(0|g/65536)+e*a)&65535,m[15]=0|g/65536,m}function h(e,t){var n=c(e[15],e[14],e[13],e[12],e[11],e[10],e[9],e[8],t[15],t[14],t[13],t[12],t[11],t[10],t[9],t[8]),r=c(e[7],e[6],e[5],e[4],e[3],e[2],e[1],e[0],t[7],t[6],t[5],t[4],t[3],t[2],t[1],t[0]),i=c(e[15]+e[7],e[14]+e[6],e[13]+e[5],e[12]+e[4],e[11]+e[3],e[10]+e[2],e[9]+e[1],e[8]+e[0],t[15]+t[7],t[14]+t[6],t[13]+t[5],t[12]+t[4],t[11]+t[3],t[10]+t[2],t[9]+t[1],t[8]+t[0]),s=[],o;return s[0]=(o=8388608+r[0]+(i[8]-n[8]-r[8]+n[0]-128)*38)&65535,s[1]=(o=8388480+(o>>>16)+r[1]+(i[9]-n[9]-r[9]+n[1])*38)&65535,s[2]=(o=8388480+(o>>>16)+r[2]+(i[10]-n[10]-r[10]+n[2])*38)&65535,s[3]=(o=8388480+(o>>>16)+r[3]+(i[11]-n[11]-r[11]+n[3])*38)&65535,s[4]=(o=8388480+(o>>>16)+r[4]+(i[12]-n[12]-r[12]+n[4])*38)&65535,s[5]=(o=8388480+(o>>>16)+r[5]+(i[13]-n[13]-r[13]+n[5])*38)&65535,s[6]=(o=8388480+(o>>>16)+r[6]+(i[14]-n[14]-r[14]+n[6])*38)&65535,s[7]=(o=8388480+(o>>>16)+r[7]+(i[15]-n[15]-r[15]+n[7])*38)&65535,s[8]=(o=8388480+(o>>>16)+r[8]+i[0]-n[0]-r[0]+n[8]*38)&65535,s[9]=(o=8388480+(o>>>16)+r[9]+i[1]-n[1]-r[1]+n[9]*38)&65535,s[10]=(o=8388480+(o>>>16)+r[10]+i[2]-n[2]-r[2]+n[10]*38)&65535,s[11]=(o=8388480+(o>>>16)+r[11]+i[3]-n[3]-r[3]+n[11]*38)&65535,s[12]=(o=8388480+(o>>>16)+r[12]+i[4]-n[4]-r[4]+n[12]*38)&65535,s[13]=(o=8388480+(o>>>16)+r[13]+i[5]-n[5]-r[5]+n[13]*38)&65535,s[14]=(o=8388480+(o>>>16)+r[14]+i[6]-n[6]-r[6]+n[14]*38)&65535,s[15]=8388480+(o>>>16)+r[15]+i[7]-n[7]-r[7]+n[15]*38,p(s),s}function p(e){var t=e[15];e[15]=t&32767,t=(0|t/32768)*19,e[0]=(t+=e[0])&65535,t>>>=16,e[1]=(t+=e[1])&65535,t>>>=16,e[2]=(t+=e[2])&65535,t>>>=16,e[3]=(t+=e[3])&65535,t>>>=16,e[4]=(t+=e[4])&65535,t>>>=16,e[5]=(t+=e[5])&65535,t>>>=16,e[6]=(t+=e[6])&65535,t>>>=16,e[7]=(t+=e[7])&65535,t>>>=16,e[8]=(t+=e[8])&65535,t>>>=16,e[9]=(t+=e[9])&65535,t>>>=16,e[10]=(t+=e[10])&65535,t>>>=16,e[11]=(t+=e[11])&65535,t>>>=16,e[12]=(t+=e[12])&65535,t>>>=16,e[13]=(t+=e[13])&65535,t>>>=16,e[14]=(t+=e[14])&65535,t>>>=16,e[15]+=t}function d(e,t){var n=[],r;return n[0]=(r=((0|e[15]>>>15)+(0|t[15]>>>15))*19+e[0]+t[0])&65535,n[1]=(r=(r>>>16)+e[1]+t[1])&65535,n[2]=(r=(r>>>16)+e[2]+t[2])&65535,n[3]=(r=(r>>>16)+e[3]+t[3])&65535,n[4]=(r=(r>>>16)+e[4]+t[4])&65535,n[5]=(r=(r>>>16)+e[5]+t[5])&65535,n[6]=(r=(r>>>16)+e[6]+t[6])&65535,n[7]=(r=(r>>>16)+e[7]+t[7])&65535,n[8]=(r=(r>>>16)+e[8]+t[8])&65535,n[9]=(r=(r>>>16)+e[9]+t[9])&65535,n[10]=(r=(r>>>16)+e[10]+t[10])&65535,n[11]=(r=(r>>>16)+e[11]+t[11])&65535,n[12]=(r=(r>>>16)+e[12]+t[12])&65535,n[13]=(r=(r>>>16)+e[13]+t[13])&65535,n[14]=(r=(r>>>16)+e[14]+t[14])&65535,n[15]=(r>>>16)+(e[15]&32767)+(t[15]&32767),n}function v(e,t){var n=[],r;return n[0]=(r=524288+((0|e[15]>>>15)-(0|t[15]>>>15)-1)*19+e[0]-t[0])&65535,n[1]=(r=(r>>>16)+524280+e[1]-t[1])&65535,n[2]=(r=(r>>>16)+524280+e[2]-t[2])&65535,n[3]=(r=(r>>>16)+524280+e[3]-t[3])&65535,n[4]=(r=(r>>>16)+524280+e[4]-t[4])&65535,n[5]=(r=(r>>>16)+524280+e[5]-t[5])&65535,n[6]=(r=(r>>>16)+524280+e[6]-t[6])&65535,n[7]=(r=(r>>>16)+524280+e[7]-t[7])&65535,n[8]=(r=(r>>>16)+524280+e[8]-t[8])&65535,n[9]=(r=(r>>>16)+524280+e[9]-t[9])&65535,n[10]=(r=(r>>>16)+524280+e[10]-t[10])&65535,n[11]=(r=(r>>>16)+524280+e[11]-t[11])&65535,n[12]=(r=(r>>>16)+524280+e[12]-t[12])&65535,n[13]=(r=(r>>>16)+524280+e[13]-t[13])&65535,n[14]=(r=(r>>>16)+524280+e[14]-t[14])&65535,n[15]=(r>>>16)+32760+(e[15]&32767)-(t[15]&32767),n}function m(e){var t=e,n=250;while(--n)e=l(e),e=h(e,t);return e=l(e),e=l(e),e=h(e,t),e=l(e),e=l(e),e=h(e,t),e=l(e),e=h(e,t),e}function g(e){var t=121665,n=[],r;return n[0]=(r=e[0]*t)&65535,n[1]=(r=(0|r/65536)+e[1]*t)&65535,n[2]=(r=(0|r/65536)+e[2]*t)&65535,n[3]=(r=(0|r/65536)+e[3]*t)&65535,n[4]=(r=(0|r/65536)+e[4]*t)&65535,n[5]=(r=(0|r/65536)+e[5]*t)&65535,n[6]=(r=(0|r/65536)+e[6]*t)&65535,n[7]=(r=(0|r/65536)+e[7]*t)&65535,n[8]=(r=(0|r/65536)+e[8]*t)&65535,n[9]=(r=(0|r/65536)+e[9]*t)&65535,n[10]=(r=(0|r/65536)+e[10]*t)&65535,n[11]=(r=(0|r/65536)+e[11]*t)&65535,n[12]=(r=(0|r/65536)+e[12]*t)&65535,n[13]=(r=(0|r/65536)+e[13]*t)&65535,n[14]=(r=(0|r/65536)+e[14]*t)&65535,n[15]=(0|r/65536)+e[15]*t,p(n),n}function y(e,t){var n,r,i,s,o;return i=l(d(e,t)),s=l(v(e,t)),o=v(i,s),n=h(s,i),r=h(d(g(o),i),o),[n,r]}function b(e,t,n,r,i){var s,o,u,a;return u=h(v(e,t),d(n,r)),a=h(d(e,t),v(n,r)),s=l(d(u,a)),o=h(l(v(u,a)),i),[s,o]}var e={};return e.getbit=n,e.setbit=t,e.invmodp=m,e.mulmodp=h,e.reduce=p,e.dbl=y,e.sum=b,e.ZERO=r,e.ONE=i,e.BASE=s,e.bigintadd=u,e.bigintsub=a,e.bigintcmp=o,e.mulmodp=h,e.sqrmodp=l,e}),n("jodid25519/utils",[],function(){function n(e){var n=[];for(var r=e.length-1;r>=0;r--){var i=e[r];n.push(t.substr(i>>>12&15,1)),n.push(t.substr(i>>>8&15,1)),n.push(t.substr(i>>>4&15,1)),n.push(t.substr(i&15,1))}return n.join("")}function r(e){var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(var r=e.length-1,i=0;r>=0;r-=4)n[i]=t.indexOf(e.charAt(r))|t.indexOf(e.charAt(r-1))<<4|t.indexOf(e.charAt(r-2))<<8|t.indexOf(e.charAt(r-3))<<12,i++;return n}function o(e){var t,n="";for(t=0;t<255;t+=5)n=i.substr(core.getbit(e,t)+(core.getbit(e,t+1)<<1)+(core.getbit(e,t+2)<<2)+(core.getbit(e,t+3)<<3)+(core.getbit(e,t+4)<<4),1)+n;return n}function u(e){var t=0,n=core.ZERO(),r=e.length;for(t=0;r>0&&t<255;t+=5){r--;var i=s[e.substr(r,1)];core.setbit(n,t,i&1),i>>=1,core.setbit(n,t+1,i&1),i>>=1,core.setbit(n,t+2,i&1),i>>=1,core.setbit(n,t+3,i&1),i>>=1,core.setbit(n,t+4,i&1)}return n}function a(e,t){var n=new Array(t.length);for(var r=0;r<t.length;r++)n[r]=e(t[r]);return n}function f(e){return String.fromCharCode(e)}function l(e){return e.charCodeAt(0)}function c(e){return a(f,e).join("")}function h(e){return a(l,e)}var e={},t="0123456789abcdef",i="abcdefghijklmnopqrstuvwxyz234567",s=function(){var e={};for(var t=0;t<i.length;t++)e[i.charAt(t)]=t;return e}();return e.hexEncode=n,e.hexDecode=r,e.base32encode=o,e.base32decode=u,e.bytes2string=c,e.string2bytes=h,e}),n("jodid25519/curve255",["jodid25519/core","jodid25519/utils"],function(e,t){function r(t,n){var r,i,s;i=n,r=e.dbl(i,e.ONE()),s=[i,e.ONE()];var o=255;while(e.getbit(t,o)==0){o--;if(o<0)return e.ZERO()}o--;var u=[r,s];while(o>=0){var a,f,l=e.getbit(t,o);a=e.sum(u[0][0],u[0][1],u[1][0],u[1][1],i),f=e.dbl(u[1-l][0],u[1-l][1]),u[1-l]=f,u[l]=a,o--}return s=u[1],s[1]=e.invmodp(s[1]),s[0]=e.mulmodp(s[0],s[1]),e.reduce(s[0]),s[0]}function i(e,t){return _base32encode(s(_base32decode(e),_base32decode(t)))}function s(t,n){return n||(n=e.BASE()),t[0]&=65528,t[15]=t[15]&32767|16384,r(t,n)}function o(e){var n=t.hexEncode(e);return n=(new Array(65-n.length)).join("0")+n,n.split(/(..)/).reverse().join("")}function u(e){var n=e.split(/(..)/).reverse().join("");return t.hexDecode(n)}var n={};return n.curve25519=s,n.curve25519_raw=r,n.hexEncodeVector=o,n.hexDecodeVector=u,n.hexencode=t.hexEncode,n.hexdecode=t.hexDecode,n.base32encode=t.base32encode,n.base32decode=t.base32decode,n}),n("jodid25519/dh",["jodid25519/core","jodid25519/utils","jodid25519/curve255"],function(e,t,n){function i(e){var t=[];for(var n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]&255)),t.push(String.fromCharCode(e[n]>>>8));return t.join("")}function s(e){var t=new Array(16);for(var n=0,r=0;n<e.length;n+=2)t[r]=e.charCodeAt(n+1)<<8|e.charCodeAt(n),r++;return t}var r={};return r.computeKey=function(e,t){return t?i(n.curve25519(s(e),s(t))):i(n.curve25519(s(e)))},r.publicKey=function(e){return i(n.curve25519(s(e)))},r}),n("jsbn1",function(e){return function(){var t,n;return t||e.jsbn1}}(this)),n("jsbn",["jsbn1"],function(e){return function(){var t,n;return n=function(e){return{BigInteger:BigInteger}},t=n.apply(e,arguments),t||e.jsbn}}(this)),n("jodid25519/eddsa",["jodid25519/core","jodid25519/curve255","jodid25519/utils","jsbn"],function(e,t,n,r){function s(e){if(!(this instanceof s))return new s(e);if(typeof e=="undefined")return c;var t=e.constructor;if(t===Array&&e.length===16)this.n=e;else if(t===Array&&e.length===32)this.n=f(e).n;else if(t===String)this.n=n.hexDecode(e);else if(t===Number)this.n=[e&65535,e>>16,0,0,0,0,0,0,0,0,0,0,0,0,0,0];else{if(!(e instanceof s))throw"Bad argument for bignum: "+e;this.n=e.n.slice(0)}}function o(e,t){var n=0;for(var r=0;r<16;r++){var i=e[r]>>16-t;e[r]=e[r]<<t&65535|n,n=i}return e}function u(e,t){var n=0;for(var r=15;r>=0;r--){var i=e[r]<<16-t&65535;e[r]=e[r]>>t|n,n=i}return e}function a(e){e=s(e);var t=new Array(32);for(var n=31;n>=0;n--)t[n]=e.n[0]&255,e.shiftRight(8);return t}function f(e){var t=c;for(var n=0;n<32;n++)t.shiftLeft(8),t=t.plus(s(e[n]));return t}function l(t,n){var r=e.ONE();for(var i=0;i<256;i++)e.getbit(n,i)===1&&(r=e.mulmodp(r,t)),t=e.sqrmodp(t);return r}function v(e){return E(e.n),e.cmp(d)>=0?v(e.minus(d)):e.cmp(c)===-1?v(e.plus(d)):e}function E(e){var t=e.slice(0),n=[e,t],r=e[15],i=n[r>>>15&1];i[15]=r&32767,r=(r>>>15)*19,i[0]=(r+=i[0])&65535,r>>>=16,i[1]=(r+=i[1])&65535,r>>>=16,i[2]=(r+=i[2])&65535,r>>>=16,i[3]=(r+=i[3])&65535,r>>>=16,i[4]=(r+=i[4])&65535,r>>>=16,i[5]=(r+=i[5])&65535,r>>>=16,i[6]=(r+=i[6])&65535,r>>>=16,i[7]=(r+=i[7])&65535,r>>>=16,i[8]=(r+=i[8])&65535,r>>>=16,i[9]=(r+=i[9])&65535,r>>>=16,i[10]=(r+=i[10])&65535,r>>>=16,i[11]=(r+=i[11])&65535,r>>>=16,i[12]=(r+=i[12])&65535,r>>>=16,i[13]=(r+=i[13])&65535,r>>>=16,i[14]=(r+=i[14])&65535,r>>>=16,i[15]+=r}function S(e){var t=e[0],n=e[1],r=t.sqr(),i=n.sqr(),s=g.times(r).times(i);return i.minus(r).minus(h).minus(s).modq().equals(c)}function x(e){var t=e.sqr(),n=t.minus(h).divide(h.plus(g.times(t))),r=n.pow(m);return r.times(r).minus(n).equals(c)||(r=r.times(y)),r.isOdd()&&(r=d.minus(r)),r}function T(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],o=t[0],u=t[1],a=t[2],f=t[3],l=r.minus(n).times(u.plus(o)),c=r.plus(n).times(u.minus(o)),h=i.times(p).times(f),d=s.times(p).times(a),v=d.plus(h),m=c.minus(l),g=c.plus(l),y=d.minus(h);return[v.times(m),g.times(y),m.times(g),v.times(y)]}function N(e){var t=e[0],n=e[1],r=e[2],i=t.times(t),s=n.times(n),o=p.times(r).times(r),u=d.minus(i),a=t.plus(n),f=a.times(a).minus(i).minus(s),l=u.plus(s),c=l.minus(o),h=u.minus(s);return[f.times(c),l.times(h),c.times(l),f.times(h)]}function C(e,t){if(t.equals(c))return[c,h,h,c];var n=t.isOdd();t.shiftRight(1);var r=N(C(e,t));return n?T(r,e):r}function k(e){var t=e[0],n=e[1];return[t,n,h,t.times(n)]}function L(e){var t=e[0],n=e[1],r=e[2],i=r.inv();return[t.times(i),n.times(i)]}function A(e,t){return L(C(k(e),t))}function O(e,t){return e[e.length-(t>>>3)-1]>>(t&7)&1}function M(e,t){var n=[c,h,h,c];for(var r=(t.length<<3)-1;r>=0;r--)n=N(n),O(t,r)===1&&(n=T(n,e));return n}function _(e,t){return L(M(k(e),t))}function B(e){return e.bytes(32).reverse()}function j(e){return s(e.slice(0).reverse())}function F(e){var t=B(e[1]);return e[0].isOdd()&&(t[31]|=128),t}function I(e){e=e.slice(0);var t=e[31]>>7;e[31]&=127;var n=j(e),r=x(n);(r.n[0]&1)!==t&&(r=d.minus(r));var i=[r,n];if(!S(i))throw"Point is not on curve";return i}function q(e,t){if(t!==undefined)return t===256?q(n.string2bytes(e)):new r.BigInteger(e,t);if(typeof e=="string")return new r.BigInteger(e,10);if(e instanceof Array||e instanceof Uint8Array)return new r.BigInteger(e);if(typeof e=="number")return new r.BigInteger(e.toString(),10);throw"Can't convert "+e+" to BigInteger"}function R(e,t){t===undefined&&(t=e.bitLength()+7>>>3);var n=new Array(t);for(var r=t-1;r>=0;r--)n[r]=e[0]&255,e=e.shiftRight(8);return n}function U(e){return R(q(asmCrypto.SHA512.bytes(e)),64).reverse()}function z(e){return K(Q,R(q(asmCrypto.SHA512.bytes(e)),64)).join("")}function W(e){return q([0].concat(U(e)))}function X(e){return s(U(e).slice(32,64))}function V(e){return W(e).mod(w)}function $(e){var t=X(e);return t.n[0]&=65528,t.n[15]&=16383,t.n[15]|=16384,t}function J(e){return F(A(H,$(e)))}function K(e,t){var n=new Array(t.length);for(var r=0;r<t.length;r++)n[r]=e(t[r]);return n}function Q(e){return String.fromCharCode(e)}function G(e){return e.charCodeAt(0)}function Y(e,t){return L(T(k(e),k(t)))}var i={};s.prototype={toString:function(){return n.hexEncode(this.n)},toSource:function(){return"_"+n.hexEncode(this.n)},plus:function(t){return s(e.bigintadd(this.n,t.n))},minus:function(t){return s(e.bigintsub(this.n,t.n)).modq()},times:function(t){return s(e.mulmodp(this.n,t.n))},divide:function(e){return this.times(e.inv())},sqr:function(){return s(e.sqrmodp(this.n))},cmp:function(t){return e.bigintcmp(this.n,t.n)},equals:function(e){return this.cmp(e)===0},isOdd:function(){return(this.n[0]&1)===1},shiftLeft:function(e){return o(this.n,e),this},shiftRight:function(e){return u(this.n,e),this},inv:function(){return s(e.invmodp(this.n))},pow:function(e){return s(l(this.n,e.n))},modq:function(){return v(this)},bytes:function(){return a(this)}};var c=s(0),h=s(1),p=s(2),d=s([65517,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,32767]),m=s("0ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe"),g=s("52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),y=s("2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0"),b=s("1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),w=q("1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed",16),D=s(4).divide(s(5)),P=x(D),H=[P,D];return r.BigInteger.prototype.bytes=function(e){return R(this,e)},i.isOnCurve=function(e){try{S(I(n.string2bytes(e)))}catch(t){if(t==="Point is not on curve")return!1;throw t}return!0},i.publicKey=function(e){return n.bytes2string(J(e))},i.signature=function(e,t,r){r===undefined?r=J(t):r=n.string2bytes(r);var i=q($(t).toString(),16),s=z(t),o=U(s.slice(32,64)+e),u=_(H,o),a=F(u);o=q(o).mod(q(1,10).shiftLeft(512));var f=K(Q,a).join("")+K(Q,r).join("")+e;return f=V(f).multiply(i).add(o).mod(w),n.bytes2string(a.concat(B(f)))},i.checkSig=function(e,t,r){e=n.string2bytes(e.slice(0,64)),r=n.string2bytes(r);var i=e.slice(0,32),s=I(i),o=I(r),u=j(e.slice(32,64)),a=W(n.bytes2string(i.concat(r))+t),f=A(H,u),l=_(o,R(a)),c=Y(s,l);return f[0].equals(c[0])&&f[1].equals(c[1])},i.genKeySeed=function(){var e=new Uint8Array(32);asmCrypto.getRandomValues(e);var t=[];for(var n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")},i}),n("jodid25519",["jodid25519/dh","jodid25519/eddsa","jodid25519/curve255","jodid25519/utils"],function(e,t,n,r){var i={};return i.VERSION="0.7.0",i.dh=e,i.eddsa=t,i.curve255=n,i.utils=r,i}),t("jodid25519")});